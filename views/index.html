<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Socket.io</title>
</head>
<body>
<h1>Le vol !</h1>

<script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io.connect('http://localhost:8080');

    socket.on('vols', function(message) {
        console.log('Le serveur a un message pour vous : ' +            message);
        afficherLesVols(message);
    })

    socket.on('voldetails', function(message) {
        console.log('Ldetails ' +            message);
        afficherDetails(message);
    })
    // AafficherLesVols
    function afficherLesVols(results) {
       var myTable = "<table border='4'> <tr><th>Id</th><th>Orientation</th> </tr>";

        for(let item of results.keys()){
            myTable+= "<tr><td>" + results[item].id  + "</td><td> <a onClick='demanderDetails("+ results[item].id + ");' href=#>"+ results[item].orientation+"</a></tr>" ;
        }
          myTable +=  '</table>' ;
          $('#vols').prepend(  myTable );
      }

    function demanderDetails(volId)
    {
        socket.emit('voldetails', volId);
    }
    function afficherDetails(results)
    { $('#details').empty();
        var myTable = "<table border='4'> <tr><th>Information</th><th>Val</th> </tr>";

        for(let item of results.keys()){
            myTable+= "<tr><td>" + results[item].id  + "</td><td> <a onClick='demanderDetails("+ results[item].id + ");' href=#>"+ results[item].type+"</a></tr>" ;
        }
        myTable +=  '</table>' ;
        $('#details').prepend(  myTable );
    }


</script>

<div id="vols">
</div>
<div id="details">
</div>
</body>
</html>
